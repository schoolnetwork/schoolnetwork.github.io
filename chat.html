<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SchoolNet Chat</title>
    <link rel="stylesheet" href="./css/master.css" />
  </head>
  <body>
    <div class="container">
      <h1>Welcome to SchoolNet Chat</h1>

      <!-- Username input -->
      <input type="text" id="username" placeholder="Enter your username" />

      <!-- Message display section -->
      <div id="messages"></div>

      <!-- Input area to send messages -->
      <div id="input-container">
        <input type="text" id="message" placeholder="Type your message" />
        <button id="sendMessage">Send</button>
      </div>

      <!-- Owner Panel -->
      <div id="ownerPanel" style="display: none">
        <h3>Owner Panel</h3>
        <input type="password" id="ownerPassword" placeholder="Enter password" />
        <button id="deleteMessageBtn">Delete Message</button>
      </div>

      <!-- Back to Home Button -->
      <button id="backHome" onclick="window.location.href='/index.html'">Back Home</button>
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script>
      const socket = io();

      document.getElementById('sendMessage').addEventListener('click', function (event) {
        event.preventDefault(); // Prevent page reload

        const user = document.getElementById('username').value;
        const message = document.getElementById('message').value;

        if (user && message) {
          socket.emit('chat message', { user: user, msg: message });
          document.getElementById('message').value = ''; // Clear the input field
        }
      });

      // Listen for incoming chat messages from other users
      socket.on('chat message', function (msgData) {
        const messageContainer = document.createElement('div');
        messageContainer.classList.add('message');
        messageContainer.innerHTML = `<strong>${msgData.user}:</strong> ${msgData.msg}`;
        document.getElementById('messages').appendChild(messageContainer);
      });

      // Check for owner password and show owner panel
      document.getElementById('ownerPassword').addEventListener('input', function () {
        const password = document.getElementById('ownerPassword').value;
        if (password === 'owneriscool') {
          document.getElementById('ownerPanel').style.display = 'block';
        } else {
          document.getElementById('ownerPanel').style.display = 'none';
        }
      });

      // Delete message (for owner only)
      document.getElementById('deleteMessageBtn').addEventListener('click', function () {
        // Logic to delete messages can be implemented here
        alert('Message deleted! (Implement your logic)');
      });
    </script>
  </body>
</html>
